[mode]
threads = 3
retry = 1
monitor_resource = True
monitor_time_step = 2
check_resource_before_run = True

[RawDataQC_sampleA]
cmd = /data/packages/bin/fastqc --outdir D:\PycharmProjects\nestcmd\result\RawDataQC --threads 3 --dir D:\PycharmProjects\nestcmd\result\RawDataQC --extract /data/users/dqgu/PycharmProjects/nestcmd/testdata/reads2.left.fq.gz /data/users/dqgu/PycharmProjects/nestcmd/testdata/reads2.right.fq.gz 
cpu = 1
mem = 209715200
retry = 1
monitor_resource = True
monitor_time_step = 2
check_resource_before_run = True

[RawDataQC_sampleB]
cmd = /data/packages/bin/fastqc --outdir D:\PycharmProjects\nestcmd\result\RawDataQC --threads 3 --dir D:\PycharmProjects\nestcmd\result\RawDataQC --extract /data/users/dqgu/PycharmProjects/nestcmd/testdata/reads2.left.fq.gz /data/users/dqgu/PycharmProjects/nestcmd/testdata/reads2.right.fq.gz 
cpu = 1
mem = 209715200
retry = 1
monitor_resource = True
monitor_time_step = 2
check_resource_before_run = True

[Trim_sampleA]
cmd = /usr/bin/java -jar /data/packages/Trimmomatic-0.36/trimmomatic-0.36.jar PE -threads 10 /data/users/dqgu/PycharmProjects/nestcmd/testdata/reads2.left.fq.gz /data/users/dqgu/PycharmProjects/nestcmd/testdata/reads2.right.fq.gz D:\PycharmProjects\nestcmd\result\Trim\sampleA_clean_R1.fq.gz D:\PycharmProjects\nestcmd\result\Trim\sampleA_unpaired_clean_R1.fq.gz D:\PycharmProjects\nestcmd\result\Trim\sampleA_clean_R2.fq.gz D:\PycharmProjects\nestcmd\result\Trim\sampleA_unpaired_clean_R2.fq.gz ILLUMINACLIP:/data/packages/Trimmomatic-0.36/adapters/all-PE.fasta:2:30:10 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36 -trimlog D:\PycharmProjects\nestcmd\result\Trim\trim.log 
cpu = 1
mem = 209715200
retry = 1
monitor_resource = True
monitor_time_step = 2
check_resource_before_run = True
sample_name = sampleA
trimmed_fq1 = D:\PycharmProjects\nestcmd\result\Trim\sampleA_clean_R1.fq.gz
trimmed_fq2 = D:\PycharmProjects\nestcmd\result\Trim\sampleA_clean_R2.fq.gz

[Trim_sampleB]
cmd = /usr/bin/java -jar /data/packages/Trimmomatic-0.36/trimmomatic-0.36.jar PE -threads 10 /data/users/dqgu/PycharmProjects/nestcmd/testdata/reads2.left.fq.gz /data/users/dqgu/PycharmProjects/nestcmd/testdata/reads2.right.fq.gz D:\PycharmProjects\nestcmd\result\Trim\sampleB_clean_R1.fq.gz D:\PycharmProjects\nestcmd\result\Trim\sampleB_unpaired_clean_R1.fq.gz D:\PycharmProjects\nestcmd\result\Trim\sampleB_clean_R2.fq.gz D:\PycharmProjects\nestcmd\result\Trim\sampleB_unpaired_clean_R2.fq.gz ILLUMINACLIP:/data/packages/Trimmomatic-0.36/adapters/all-PE.fasta:2:30:10 LEADING:3 TRAILING:3 SLIDINGWINDOW:4:15 MINLEN:36 -trimlog D:\PycharmProjects\nestcmd\result\Trim\trim.log 
cpu = 1
mem = 209715200
retry = 1
monitor_resource = True
monitor_time_step = 2
check_resource_before_run = True
sample_name = sampleB
trimmed_fq1 = D:\PycharmProjects\nestcmd\result\Trim\sampleB_clean_R1.fq.gz
trimmed_fq2 = D:\PycharmProjects\nestcmd\result\Trim\sampleB_clean_R2.fq.gz

[TrimmedDataQC_sampleB]
cmd = /data/packages/bin/fastqc --outdir D:\PycharmProjects\nestcmd\result\TrimmedDataQC --threads 3 --dir D:\PycharmProjects\nestcmd\result\TrimmedDataQC --extract D:\PycharmProjects\nestcmd\result\Trim\sampleB_clean_R1.fq.gz D:\PycharmProjects\nestcmd\result\Trim\sampleB_clean_R2.fq.gz 
cpu = 1
mem = 209715200
retry = 1
monitor_resource = True
monitor_time_step = 2
check_resource_before_run = True
depend = Trim_sampleB
result_dir = D:\PycharmProjects\nestcmd\result\TrimmedDataQC
sample_name = sampleB

[TrimmedDataQC_sampleA]
cmd = /data/packages/bin/fastqc --outdir D:\PycharmProjects\nestcmd\result\TrimmedDataQC --threads 3 --dir D:\PycharmProjects\nestcmd\result\TrimmedDataQC --extract D:\PycharmProjects\nestcmd\result\Trim\sampleA_clean_R1.fq.gz D:\PycharmProjects\nestcmd\result\Trim\sampleA_clean_R2.fq.gz 
cpu = 1
mem = 209715200
retry = 1
monitor_resource = True
monitor_time_step = 2
check_resource_before_run = True
depend = Trim_sampleA
result_dir = D:\PycharmProjects\nestcmd\result\TrimmedDataQC
sample_name = sampleA

[AlignIndex]
cmd = /data/packages/bin/STAR --runThreadN 10 --runMode genomeGenerate --genomeDir /mnt/resources/1_human_reference/b37/b37_star_mapping_indices --genomeFastaFiles /mnt/resources/1_human_reference/b37/GRCh37.primary_assembly.genome.fa --sjdbGTFfile /mnt/resources/1_human_reference/b37/Homo_sapiens.GRCh37.75.gtf --sjdbOverhang 130 
cpu = 1
mem = 209715200
retry = 1
monitor_resource = True
monitor_time_step = 2
check_resource_before_run = True

[Align_sampleB]
cmd = /data/packages/bin/STAR --runThreadN 10 --genomeDir /mnt/resources/1_human_reference/b37/b37_star_mapping_indices --readFilesIn D:\PycharmProjects\nestcmd\result\Trim\sampleB_clean_R1.fq.gz D:\PycharmProjects\nestcmd\result\Trim\sampleB_clean_R2.fq.gz --outFileNamePrefix  D:\PycharmProjects\nestcmd\result\Align\sampleB\sampleB. --outSAMtype BAM SortedByCoordinate --outSAMunmapped Within --readFilesCommand zcat --twopassMode Basic --outFilterMultimapNmax 1 --alignSJoverhangMin 8 --alignSJDBoverhangMin 1 --chimSegmentMin 20 --outFilterMismatchNoverLmax 0.04 --outFilterType BySJout --outSAMstrandField intronMotif --quantMode TranscriptomeSAM 
cpu = 2
mem = 2147483648
retry = 1
monitor_resource = True
monitor_time_step = 5
check_resource_before_run = True
depend = AlignIndex,Trim_sampleB
sorted_bam = D:\PycharmProjects\nestcmd\result\Align\sampleB\sampleB.Aligned.sortedByCoord.out.bam
sample_name = sampleB
result_dir = D:\PycharmProjects\nestcmd\result\Align\sampleB

[Align_sampleA]
cmd = /data/packages/bin/STAR --runThreadN 10 --genomeDir /mnt/resources/1_human_reference/b37/b37_star_mapping_indices --readFilesIn D:\PycharmProjects\nestcmd\result\Trim\sampleA_clean_R1.fq.gz D:\PycharmProjects\nestcmd\result\Trim\sampleA_clean_R2.fq.gz --outFileNamePrefix  D:\PycharmProjects\nestcmd\result\Align\sampleA\sampleA. --outSAMtype BAM SortedByCoordinate --outSAMunmapped Within --readFilesCommand zcat --twopassMode Basic --outFilterMultimapNmax 1 --alignSJoverhangMin 8 --alignSJDBoverhangMin 1 --chimSegmentMin 20 --outFilterMismatchNoverLmax 0.04 --outFilterType BySJout --outSAMstrandField intronMotif --quantMode TranscriptomeSAM 
cpu = 2
mem = 2147483648
retry = 1
monitor_resource = True
monitor_time_step = 5
check_resource_before_run = True
depend = AlignIndex,Trim_sampleA
sorted_bam = D:\PycharmProjects\nestcmd\result\Align\sampleA\sampleA.Aligned.sortedByCoord.out.bam
sample_name = sampleA
result_dir = D:\PycharmProjects\nestcmd\result\Align\sampleA

[Assembly_sampleB]
cmd = /data/packages/bin/scallop -i D:\PycharmProjects\nestcmd\result\Align\sampleB\sampleB.Aligned.sortedByCoord.out.bam -o D:\PycharmProjects\nestcmd\result\Assembly\sampleB\sampleB.scallop.gtf --library_type unstranded --min_transcript_coverage 1 --min_single_exon_coverage 20 --min_transcript_length_increase 50 --min_transcript_length_base 150 --min_mapping_quality 1 --max_num_cigar 7 --min_bundle_gap 50 --min_num_hits_in_bundle 20 --min_flank_length 3 --min_splice_bundary_hits 1 
cpu = 2
mem = 2147483648
retry = 1
monitor_resource = True
monitor_time_step = 5
check_resource_before_run = True
depend = Align_sampleB
sample_name = sampleB
out_gtf = D:\PycharmProjects\nestcmd\result\Assembly\sampleB\sampleB.scallop.gtf

[Assembly_sampleA]
cmd = /data/packages/bin/scallop -i D:\PycharmProjects\nestcmd\result\Align\sampleA\sampleA.Aligned.sortedByCoord.out.bam -o D:\PycharmProjects\nestcmd\result\Assembly\sampleA\sampleA.scallop.gtf --library_type unstranded --min_transcript_coverage 1 --min_single_exon_coverage 20 --min_transcript_length_increase 50 --min_transcript_length_base 150 --min_mapping_quality 1 --max_num_cigar 7 --min_bundle_gap 50 --min_num_hits_in_bundle 20 --min_flank_length 3 --min_splice_bundary_hits 1 
cpu = 2
mem = 2147483648
retry = 1
monitor_resource = True
monitor_time_step = 5
check_resource_before_run = True
depend = Align_sampleA
sample_name = sampleA
out_gtf = D:\PycharmProjects\nestcmd\result\Assembly\sampleA\sampleA.scallop.gtf

[MergeTranscript]
cmd = /data/users/dqgu/anaconda3/bin/python /data/users/dqgu/PycharmProjects/nestcmd/merge_scallop_transcripts.py -gtf D:\PycharmProjects\nestcmd\result\Assembly\sampleB\sampleB.scallop.gtf D:\PycharmProjects\nestcmd\result\Assembly\sampleA\sampleA.scallop.gtf -refgtf /mnt/resources/1_human_reference/b37/Homo_sapiens.GRCh37.75.gtf -refgenome /mnt/resources/1_human_reference/b37/GRCh37.primary_assembly.genome.fa -outdir D:\PycharmProjects\nestcmd\result\MergeTranscript -reftrans /mnt/resources/1_human_reference/b37/b37_rsem/b37_rsem.transcripts.fa -gtfmerge /data/packages/bin/gtfmerge -gffcompare /data/packages/bin/gffcompare -gtfcuff /data/packages/bin/gtfcuff -gffread /data/packages/bin/gffread 
cpu = 2
mem = 209715200
retry = 1
monitor_resource = True
monitor_time_step = 2
check_resource_before_run = True
depend = Assembly_sampleB,Assembly_sampleA
result_dir = D:\PycharmProjects\nestcmd\result\MergeTranscript
all_transcripts = D:\PycharmProjects\nestcmd\result\MergeTranscript\all.transcripts.fa
all_gtf = D:\PycharmProjects\nestcmd\result\MergeTranscript\all.transcripts.gtf

[QuantIndex]
cmd = /data/packages/bin/salmon index -t D:\PycharmProjects\nestcmd\result\MergeTranscript\all.transcripts.fa -i D:\PycharmProjects\nestcmd\result\QuantIndex -k 31 
cpu = 1
mem = 209715200
retry = 1
monitor_resource = True
monitor_time_step = 2
check_resource_before_run = True
index_prefix = D:\PycharmProjects\nestcmd\result\QuantIndex
depend = MergeTranscript
all_gtf = D:\PycharmProjects\nestcmd\result\MergeTranscript\all.transcripts.gtf

[Quant_sampleB]
cmd = /data/packages/bin/salmon quant -i /data/users/dqgu/PycharmProjects/nestcmd/salmon_index/ -l A -1 D:\PycharmProjects\nestcmd\result\Trim\sampleB_clean_R1.fq.gz -2 D:\PycharmProjects\nestcmd\result\Trim\sampleB_clean_R2.fq.gz -o D:\PycharmProjects\nestcmd\result\Quant\sampleB --gcBias -p 10 -g D:\PycharmProjects\nestcmd\result\MergeTranscript\all.transcripts.gtf 
cpu = 2
mem = 2147483648
retry = 1
monitor_resource = True
monitor_time_step = 5
check_resource_before_run = True
depend = QuantIndex,Trim_sampleB
sample_name = sampleB
result_dir = D:\PycharmProjects\nestcmd\result\Quant
prefix = D:\PycharmProjects\nestcmd\result\Quant\sampleB

[Quant_sampleA]
cmd = /data/packages/bin/salmon quant -i /data/users/dqgu/PycharmProjects/nestcmd/salmon_index/ -l A -1 D:\PycharmProjects\nestcmd\result\Trim\sampleA_clean_R1.fq.gz -2 D:\PycharmProjects\nestcmd\result\Trim\sampleA_clean_R2.fq.gz -o D:\PycharmProjects\nestcmd\result\Quant\sampleA --gcBias -p 10 -g D:\PycharmProjects\nestcmd\result\MergeTranscript\all.transcripts.gtf 
cpu = 2
mem = 2147483648
retry = 1
monitor_resource = True
monitor_time_step = 5
check_resource_before_run = True
depend = QuantIndex,Trim_sampleA
sample_name = sampleA
result_dir = D:\PycharmProjects\nestcmd\result\Quant
prefix = D:\PycharmProjects\nestcmd\result\Quant\sampleA

[MergeQuantTranscript]
cmd = /usr/bin/perl /data/packages/trinityrnaseq-Trinity-v2.8.4/util/abundance_estimates_to_matrix.pl --est_method salmon --cross_sample_norm TMM --name_sample_by_basedir --gene_trans_map none --out_prefix D:\PycharmProjects\nestcmd\result\MergeQuant\all D:\PycharmProjects\nestcmd\result\Quant/*/quant.sf 
cpu = 1
mem = 209715200
retry = 1
monitor_resource = False
monitor_time_step = 2
check_resource_before_run = False
depend = Quant_sampleB,Quant_sampleA
out_prefix = D:\PycharmProjects\nestcmd\result\MergeQuant\all
transcript_tpm_matrix = D:\PycharmProjects\nestcmd\result\MergeQuant\all.isoform.TMM.EXPR.matrix
transcript_count_matrix = D:\PycharmProjects\nestcmd\result\MergeQuant\all.isoform.counts.matrix

[MergeQuantGene]
cmd = /usr/bin/perl /data/packages/trinityrnaseq-Trinity-v2.8.4/util/abundance_estimates_to_matrix.pl --est_method salmon --cross_sample_norm TMM --name_sample_by_basedir --gene_trans_map none --out_prefix D:\PycharmProjects\nestcmd\result\MergeQuant\all D:\PycharmProjects\nestcmd\result\Quant/*/quant.genes.sf 
cpu = 1
mem = 209715200
retry = 1
monitor_resource = False
monitor_time_step = 2
check_resource_before_run = False
depend = Quant_sampleB,Quant_sampleA
out_prefix = D:\PycharmProjects\nestcmd\result\MergeQuant\all
gene_tpm_matrix = D:\PycharmProjects\nestcmd\result\MergeQuant\all.gene.TMM.EXPR.matrix
gene_count_matrix = D:\PycharmProjects\nestcmd\result\MergeQuant\all.gene.counts.matrix

